{% load static %}
<!DOCTYPE html>
<html lang="en">
<html>
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link href="https://fonts.googleapis.com/css?family=Lexend&display=swap" rel="stylesheet">
    <link id="theme-stylesheet" href="{% static 'music/light.css' %}" rel="stylesheet">
    <link href="{% static 'music/main.css' %}" rel="stylesheet">
    <title>Log In</title>
</head>
<body>
    <div class="v1_8">
        <h1 class="v1_15">Welcome to Spotify Wrapped</h1>
        <span class="v1_21">Log in to view your listening habits.</span>

        <form method="post" class="login-form">
            {% csrf_token %}
            <div class="v55_19">
                <label for="id_username" class="v55_20">Username</label>
                {{ form.username }}
            </div>
            <div class="v55_25">
                <label for="id_password" class="v55_26">Password</label>
                {{ form.password }}
            </div>
            <button type="submit" class="v1_13">Log In</button>
        </form>
        
        <p class="signup-prompt">
            <span>No account?</span>
            <a href="{% url 'signup' %}" class="v55_33">Sign up here</a>
        </p>
        
        <button id="toggle-theme" class="theme-toggle-button">Toggle Theme</button>
    </div>

    <script>
        function setTheme(theme) {
            const themeStylesheet = document.getElementById('theme-stylesheet');
            themeStylesheet.setAttribute('href',
                theme === 'dark' ? '{% static "music/dark.css" %}' :
                theme === 'light' ? '{% static "music/light.css" %}' :
                theme === 'colorful' ? '{% static "music/color.css" %}' :
                '{% static "music/light.css" %}' // Fallback
            );
            console.log("The theme has been changed!");
        }

        document.addEventListener('DOMContentLoaded', () => {
            const currentTheme = localStorage.getItem('theme') || 'light';
            setTheme(currentTheme);

            const toggleButton = document.getElementById('toggle-theme');
            toggleButton.textContent = 'Switch Theme';

            toggleButton.onclick = () => {
                const currentTheme = localStorage.getItem('theme') || 'light';
                const newTheme = currentTheme === 'dark' ? 'light' :
                                 currentTheme === 'light' ? 'colorful' :
                                 currentTheme === 'colorful' ? 'dark' : 'light';
                localStorage.setItem('theme', newTheme);
                setTheme(newTheme);
                toggleButton.textContent = 'Switch Theme';
            };
        });
    </script>
</body>
</html>

